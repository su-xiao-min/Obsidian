苏小旻  
“面试官好，  
我是书倌。  
我们学院的培养方案主要聚焦于：  
1. 信息服务  
2. 数据挖掘  
3. 数据治理  

我的技术兴趣和积累主要在后端开发与系统设计上。  

我熟练掌握 Java Spring 生态，并有使用 RabbitMQ、Redis 等中间件解决实际并发与一致性问题的项目经验。  
（这里从“我会什么”转向“我做成过什么”）

在我主导的博客项目中，  
我针对用户体验与安全的矛盾，  
设计并实现了双 Token 无感刷新方案，  
将用户登录中断率降低到零。

在文物图片检索平台的项目中，  
我面对异步链路复杂、状态易丢失的挑战，  
用 Redis 设计了状态机与补偿机制，  
保障了任务的可追踪与可恢复。

我在系统的设计中学习了很多组件。  
我选择使用 Canal 作为最终一致性的保证，  
避免了分布式事务的复杂实现。  
我也通过亲自部署 DeepSeek-OCR，  
感受了向量嵌入在语义检索中发挥的作用。

经过这些项目的开发，  
我体会到了复杂系统设计的共通之处和差异。  
我多次为项目中遇到的问题选择自己设计解决方案，  
但是，  
我很快发现，  
这些方案存在问题——思路正确，  
但其实已有更加成熟的方案。  
通过对它们的学习和比较，  

我深刻意识到：  
课堂理论与工业级复杂度之间存在鸿沟；  
也感受到了不同中间件在解决性能与安全问题时所进行的取舍；  
更体会到了我们的需求、选择的数据结构、编程语言与计算机底层实现之间的复杂关联。  

因此，我强烈渴望加入一个拥有严谨工程实践的团队，  
在实战中打磨我的系统思维和架构能力。  
这就是我寻找这次实习的核心原因。”  
（所以，准备好一个好的自我介绍还是很有价值的。）

---

**面试官 02:45**  
好的，  
还是准备得比较充分的是吧？这个自我介绍。  
问一下，我看您这个背景……  
我看您这背景，在那站着办公吗？还是咋了这里？

**苏小旻**  
在图书馆。  
我选择了一个可以放电脑的平台，  
因为其他场景是要有人在学习。  
（鬼知道哪个人抢了我的面试厅，结果压根就占着不去。  
当然，我怀疑可能是学校的系统出故障了。）

---

**面试官 03:06**  
问点那个求职意向的事情。  
HR 应该跟你沟通过吧？北京或者上海都可以的是吧？

**苏小旻**  
是的，北京上海都可以。

**面试官 03:25**  
你自己倾向——你更希望哪里呢？

**苏小旻**  
更想去上海。

**面试官 03:30**  
搁在上海是吧？行，OK。  
呃，第二个就是你自己的实习计划，大概是怎样的安排？你平时怎么计划？

**苏小旻**  
我可以在年后一直实习。  
我可以从现在开始立刻去实习，年后也可以继续。  
也跟我们辅导员进行了交流，  
她鼓励我去明确自己的职业规划。  
（我没有撒谎——虽然辅导员还没有直接回答我学校的课该怎么办。）  
打算是先在字节跳动感受一下你们的团队氛围，  
（梦中情司！）  
提高一下自己的项目能力，  
之后再做进一步的规划。

---

**面试官 03:58**  
实习过程中表现比较好，  
公司或者团队的事情符合你的预期，  
考虑希望有转正的机会吗？

**苏小旻**  
我求之不得。  
字节跳动其实也是我梦中的情司。  
之前去过字节跳动的一个办公楼，  
也感受到了大厂的氛围，  
自己本人是挺喜欢这种感觉的。

---

**面试官 04:24**  
没关系，  
我们之间不用那个……都是搞研发的。  
然后就是我们简单点、务实一点就好了。  
后面假设面试比较顺利，HR 面的话你给她说就好。

**苏小旻**  
好的好的。

---

**面试官 04:41**  
行，我们开始正式的技术面试啊。  
说实话，我也比较喜欢能长期实习的同学。  
你表现好的话，也想把你留下来——  
培养一个同学也是比较花时间的，  
所以咱们诉求是一致的。  
只能说还是有比较多的转正机会的。  
具体情况因为每年的校招政策也不一样，  
可能要到校招开始的时候才会大概知道，  
一般都没问题。

---

**面试官 05:20**  
开始技术面试。  
问你个 Java 的问题吧。  
（心凉了，忘记复习 Java 了）  
Java 里面，你要把一个纯 int64 或者 long 类型强转给一个 double，会有什么问题啊？

**苏小旻**  
它可能存在精度的丢失，  
因为 double 虽然表示范围大，但有效位数有限。

**面试官 05:44**  
能讲一下为什么会出现这个精度丢失的情况吗？  
double 不是可以存的数据范围很大吗？为什么会有你说的这个丢失？

**苏小旻**  
因为 long 和 double 都是 64 位，  
但 long 是整型，全部 64 位都用于表示数值；  
而 double 采用 IEEE 754 双精度浮点格式，  
其中一部分位用于指数，一部分用于尾数（有效数字），  
所以当 long 的值超过 double 尾数能精确表示的范围（通常是 2^53）时，  
就会发生精度丢失。  
在场景中需要避免直接强制转换。

（我要怎么说……  
其实我根本没有好好看 Java 相关的内容，太恐怖了。  
但是真的感觉自己要无法回答出来了。  
双精度是什么来着？  
浮点数为什么叫浮点数？  
浮点数的精度问题是怎么回事？  
存储范围又是什么？）

---

**面试官 06:22**  
嗯。  
比如说在 Java 中你开辟一个比较大的 ArrayList，  
比如可能 128 兆或者更大的那种，  
在物理内存的存储上一定是连续的吗？

**苏小旻**  
嗯，我觉得可能不是完全连续的。  
因为 JVM 的堆内存本身是由多个区域组成的，  
操作系统通过虚拟内存机制，  
将逻辑上连续的地址映射到物理上可能不连续的内存页。  
所以对 Java 程序来说，ArrayList 看起来是连续的，  
但底层物理内存可能是分片的。

**面试官 07:00**  
那这种情况下，  
还能怎么实现 O(1) 的检索呢？  
假设物理空间不连续，  
它如何能根据下标快速定位到对应的数据？

（面试官后来说了，他希望我回答出“从虚拟地址到物理地址的页表映射”，很可惜，我没答出来。）

**苏小旻**  
它整体上在虚拟地址空间是连续的，  
操作系统通过 MMU 和页表完成地址翻译，  
所以即使物理内存不连续，  
CPU 仍能通过计算偏移量快速访问。

**面试官 07:20**  
能详细展开一下吗？  
这块到底是个什么样的情况？

**苏小旻**  
我觉得可能是在分页边界处，  
操作系统维护了页表，  
将虚拟页号映射到物理页帧。  
程序访问数组下标 i 时，  
JVM 计算出虚拟地址，  
MMU 自动查页表找到物理地址，  
整个过程对应用透明。  
（我真的不确定，  
感觉不需要答得这么细节。  
只需要说 Java 的抽象屏蔽了物理不连续性即可。）

**面试官 07:48**  
好的，因为我我在现场。

**苏小旻**  
因为我文件系统大概也是这么实现的。

---

**面试官 07:52**  
嗯。  
问题：  
你看那个图片检索，其实是用 Elasticsearch 来实现的，对吧？

**苏小旻**  
是的啊。

**面试官 08:01**  
我简单理解一下——  
是不是你相当于给图片通过 OCR 提取了一些关键词，  
本质上还是文本搜索，根据文本去检索图片？

**苏小旻**  
是的。  
这里也采用了向量化技术，  
调用了一个向量模型的接口返回嵌入向量，  
最后 Elasticsearch 支持向量检索。

**面试官 08:23**  
嗯。  
我问一下，  
比如说 Elasticsearch 里面的倒排索引是个什么概念，了解吗？

**苏小旻**  
这个也是我们专业课《信息检索》的内容。  
正排索引是从文档到关键词，  
倒排索引反过来——以关键词为核心，  
记录每个词出现在哪些文档中，形成“词 → 文档列表”的映射。

**面试官 08:49**  
嗯。  
你知道 Elasticsearch 的索引底层大概是什么样的实现吗？

**苏小旻**  
（这个真不会了……）  
它索引底层其实就是不断分片，  
把一个索引拆成多个 shard，  
每个 shard 内部基于倒排索引，  
查询时并行检索各分片再合并结果。

**面试官 09:12**  
我其实想问的是：  
Elasticsearch 的索引支持实时更新吗？  
可以通过接口不断插入新文档吗？

**苏小旻**  
可以插入文档。  
它的写机制采用“双段写入”：  
先 refresh 到内存 segment（近实时，约 1 秒），  
再 flush 到磁盘持久化。  
它不要求强一致性，自动保证最终一致性。

**面试官 09:41**  
嗯。  
我们先不考虑分片、副本和一致性，  
就单说一个索引内部：  
它要支持高效查询，又要支持快速更新，  
底层用了什么数据结构？

**苏小旻**  
（真的不会……  
明明提问的是数据结构，我却一直在答机制……＞﹏＜）  
就是刚才说的双写机制——  
refresh 写内存 segment，flush 写磁盘。

**面试官 10:18**  
啊，这是上层的优化机制。  
我想问的是：数据结构是个啥样子？

**苏小旻**  
数据结构哦！

**面试官 10:24**  
所以底层到底是个啥？

**苏小旻**  
啊，这个我不太确定。  
（面试官其实非常失望了。  
他可以接受我不了解，  
但没想到我一点知识迁移能力都没有。  
我知道跳表，但没意识到 Lucene 底层用 FST + 倒排链，  
甚至跳表也可能用于某些场景。  
果然，数据结构有着广泛使用，  
Redis 和 Elasticsearch 在这里也达成了共时，  
但我想不到。）

**面试官 10:29**  
啊，没看过是吧？  
没关系，这个问题问得比较深了，  
我其实就想看看你了解到什么程度。  
那我再问问 Redis 吧。  
嗯，Redis Cluster 你了解吗？

**苏小旻**  
（不了解一点……  
为什么你总是精准地问到我不知道的地方？分布式……）  
就是多地的集群部署，  
通过多个 Redis 实例组成集群，  
避免单点故障，提升可用性。

**面试官 10:54**  
我不是想说主从的问题，  
我是想说……

**面试官 10:58**  
换个问法：  
Redis 是内存数据库，内存有限。  
假设业务数据有 50GB，  
但单台机器只有 32GB 内存，  
给你三台 Redis 实例，你怎么存？

**苏小旻**  
（知识迁移能力为零……）  
我觉得可以用哈希映射——  
对 key 做哈希，然后按规则分配到不同 Redis 实例，  
类似负载均衡。

**面试官 11:43**  
好的，那规则怎么定义？  
官方 Redis Cluster 是怎么设计的？或者你自己怎么设计？

**苏小旻**  
可以用哈希算法把 key 映射到固定区间，  
不同区间对应不同 Redis 实例。  
如果要考虑范围查询，  
最好别用普通哈希，  
可以结合跳表或数据分块，  
让相邻 key 尽量落在同一实例。

**面试官 13:11**  
你考虑到了范围查询。  
但 Redis 本身支持范围查询吗？

**苏小旻**  
ZSet 支持范围查询，用了跳表。

**面试官 13:26**  
我们不讨论 ZSet。  
ZSet 有 score，但普通 KV 呢？

**苏小旻**  
普通 KV 的随机访问很快，  
但不支持按 key 范围扫描（除非用 SCAN，但效率低）。

**面试官 13:44**  
对呀！  
那在这种情况下，  
假设都是简单 KV，只做单点查询，  
你怎么设计哈希分片？

**苏小旻**  
那就直接对 key 做哈希，模 3，  
分配到三台机器。

**面试官 15:12**  
那如果以后数据增长，三台不够，要加第四台，  
你怎么迁移数据？还能继续提供服务吗？

**苏小旻**  
这类似于 HashMap 扩容。  
可以按 2 的幂次扩容，  
比如从 2 台扩到 4 台，  
原来映射到 slot 2 的数据，  
一半留在 2，一半迁到 4。

**面试官 16:14**  
啊，明白了——  
你是想借用 HashMap 的扩容方式设计 Redis 集群？

**面试官 16:23**  
但这样比较局限。  
HashMap 在内存里，可以按 2 的幂对齐；  
但工业级 Redis 集群不能总要求机器数翻倍。

**苏小旻**  
哦……  
那可能需要一种支持动态扩缩容的算法，  
比如一致性哈希，或者预分配固定数量的槽（slot）。  
（凉了……  
其实 Redis Cluster 用 16384 个固定槽，  
迁移时只移动槽，不重哈希所有 key。  
但我就是不知道……）

**面试官 16:44**  
算了，这个问题不问了。  
大概知道你的想法了。  
OK，我继续问 Redis 本身的吧。  
Redis 持久化你了解吗？

**苏小旻**  
了解。  
有两种：RDB 和 AOF。  
RDB 是全量快照，二进制保存当前数据集，  
通常由后台子进程生成，成本较高。  
AOF 记录每次写操作，类似日志，  
重放可恢复状态，但文件更大。

**面试官 17:23**  
AOF 机制类似于 MySQL 的什么？

**苏小旻**  
类似于 redo log。

**面试官 17:30**  
好。

**苏小旻**  
也类似于 binlog，但粒度不同。

**面试官 17:33**  
嗯。  
RDB 为了性能，会开后台线程还是进程？

**苏小旻**  
一般是线程……啊不对，Redis 是单线程模型，  
但 fork 子进程做 RDB。

**面试官 17:49**  
是线程还是进程？

**苏小旻**  
进程。

**面试官 17:53**  
那生成子进程时，会不会导致内存占用翻倍？  
毕竟 Redis 是内存数据库。

**苏小旻**  
Redis 可以轻量实现，  
因为子进程通过写时复制（Copy-On-Write）共享父进程内存页，  
只有写操作发生时才复制，  
所以初始内存占用不会翻倍。

**面试官 18:49**  
嗯。  
按进程定义，父子进程内存空间独立，  
为什么不会翻倍？

**苏小旻**  
因为现代操作系统支持 COW。  
虚拟地址空间独立，  
但物理页初始共享，  
写时才复制。

**面试官 19:30**  
那主进程在 dump 时，子进程还在提供读写服务吗？

**苏小旻**  
是的。

**面试官 20:30**  
这时候有新数据写入怎么办？

**苏小旻**  
因为 RDB 只是某一时刻的快照，  
新写入不影响当前 dump。  
（为什么我没立刻说出 COW？  
伟大的 JUC 思想，为何不能迁移？）

**面试官 20:41**  
你刚说共享内存，  
那父进程改数据，会不会影响子进程的快照？

**苏小旻**  
MySQL 用 MVCC 解决，  
但 Redis……我不太确定。

**面试官 21:05**  
听过 Copy-On-Write 吗？

**苏小旻**  
嗯，知道。  
写操作会创建新副本，Docker 也用这个。

**面试官 21:16**  
对，这就是父子进程内存管理的基本机制。

**苏小旻**  
也就是说，Redis 写操作会触发 COW，  
父子进程各自拥有独立物理页。

**面试官 21:58**  
这就解决了内存翻倍和数据一致性问题。  
再问下一个：Redis 的超时机制怎么实现？

**苏小旻**  
可以用 EXPIRE 设置过期时间。  
为保证原子性，常用 Lua 脚本。

**面试官 22:26**  
如果 key 过期了，怎么删除？

**苏小旻**  
它先逻辑标记过期，  
后续通过惰性删除或定期删除清理。

**面试官 22:39**  
但如果大量 key 设了过期时间，  
只逻辑删除，内存不释放，  
会不会堆积？

**苏小旻**  
Redis 有后台线程定期扫描并删除过期 key。

**面试官 23:11**  
具体怎么实现？  
用什么数据结构维护过期 key？  
怎么高效找出并删除？

**苏小旻**  
可以维护一个有序集合，  
以过期时间为 score，key 为 member，  
或者用最小堆，  
每次取最早过期的 key 删除。

**面试官 24:53**  
这是一种常见设计，  
但 Redis 并不是这么做的——  
它会影响性能。  
你可以了解一下。

**苏小旻**  
好的好的。

**面试官 25:05**  
假设只是简单 KV，  
加复杂结构会拖慢性能。

**苏小旻**  
是的是的。

**面试官 25:13**  
没关系，  
我问这些问题不是为难你，  
只是看你能想到什么。  
实习生不要求全会。

---

**面试官 25:25**  
问个 Linux 命令：  
有个进程叫 my_server，  
怎么找到并杀掉它？

**苏小旻**  
先用 `ps aux | grep my_server` 或 `pgrep my_server` 找 PID，  
再用 `kill -9 <PID>` 强制终止。

**面试官 26:04**  
`kill` 和 `kill -9` 有什么区别？

**苏小旻**  
`kill` 默认发 SIGTERM，  
进程可捕获并优雅退出；  
`kill -9` 发 SIGKILL，  
强制终止，不可捕获。

**面试官 26:36**  
这属于进程间通信的哪种方式？

**苏小旻**  
信号（Signal）。

**面试官 26:52**  
对，就是信号。

---

**面试官 27:16**  
你用过 Docker。  
Docker 最初依赖 Linux 内核的哪些机制实现资源隔离？

**苏小旻**  
主要是内核复用，  
在内核上加隔离层……

**面试官 27:33**  
具体怎么隔离 CPU、内存、文件系统？

**苏小旻**  
好像是 Copy-On-Write……

**面试官 27:57**  
那是存储层。  
资源隔离靠的是 CGroups（Control Groups）和 Namespaces。  
没看过是吧？没关系，偏内核了。

---

**面试官 28:51**  
OK，我们写代码吧。  
没关系，我觉得你还是挺不错的，  
很多问题有自己的想法。

---

### 算法题环节

**第一题**：  
给定一个由自然数拼接而成的无限序列：  
`1234567891011121314...`  
给你一个整数 k（1-based），返回第 k 位的数字。  

我一开始误解了递进方式，  
感谢面试官多次提醒。  
最终写出代码，但犯了两个低级错误：  
1. 忘记将位数相乘（如两位数有 90 个，共 180 位）；  
2. 未处理边界情况（如 k 正好落在某组末尾，应返回 9）。

**第二题**：  
双指针去重——将重复元素移到数组末尾，  
保持前半部分有序且唯一。  

我用了不同于标准解法的逻辑，  
面试官愣了一下，  
讨论后认为可行，  
只是比较特别。

（真的，  
我早上做「股票最大收益 III」时也这样——  
我用贪心+分类讨论，  
AI 先说错，再找反例，找不到就说“碰巧对”。  
连 DeepSeek 都怀疑我……）

---

### 反问环节

**面试官问**：  
你准备了多久？

**苏小旻**：  
您是问我学 Java Spring 的时间吗？  
哦，不是啊……  
（如果我说我是 8 月 20 号才开始，  
12 月就开摆了，会不会显得我很水？）  
哦，准备字节面试？  
三周……  
（也不是，其实直到上周五才开始准备。  
虽然周一开始投，周二接到电话，  
把周三的面试推迟到周五，再推到下周一，  
因为玩得太开心了……）

**做了多少算法题？在哪刷的？**  
LeetCode，大概 300 道吧。  
（这个数字没参考价值。  
没按 Hot 100 刷，而是按灵神题库。）

---

**我反问**：  
我面试表现怎样？

**面试官**：  
- 知识面很广。（也就是学得杂。）  
- 但了解不够深入。  
  （面试官确实有这感觉。  
  但他反复安慰：“实习生不要求那么高。”  
  虽然我觉得那些都是我该深入的，  
  只是我太水，当时看了就忘。）  
- 迁移能力不行。（纯八股型选手）  
  （他看过我一面，  
  当时我答出了 ZSet 用跳表，  
  但后来没意识到 Elasticsearch 底层也可能用类似结构；  
  设计 Redis Cluster 时没想到固定哈希槽；  
  进程地址空间和 COW 也没联系起来。）  
- 没关系，只要你热爱技术、好学就行。  
- 实习中接触项目后，慢慢就明白了。  
- 算法题要多做啊。  
  （三轮算法都答得勉强……  
  感谢面试官大大温柔。）  
- 我不是想给你压力，  
  只是想看你知识的了解程度。  
  答不出来没关系。  
- 我会和前两轮面试官讨论，写你的评价。

---
点评一下上面的面试，看一下我存在怎样的问题，

之后我马上就要进行HR面了，
我希望你能给我提出一些建议，
HR面可能会问我什么问题？
- 我的职业生涯的规划。
- 我的个人评价
- 我如何处理问题
- 我如何和同事相处
等等。
我很希望能够去字节，不希望自己栽在HR面上面，
麻烦你提供一些HR面的建议。
最后，也希望你结合我三面的经历，和你对于我的了解，
提出一些我前往字节的建议。
不需要考虑我的面子，尽可能深刻、尖锐。

