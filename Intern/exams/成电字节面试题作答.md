我正在准备字节跳动的面试，麻烦你帮我改一下试卷，
尽可能严厉一些，
看一下我存在的不足。

1、redis宕机时的容灾能力

If the fail is on the Master,
then one of the slaves will be selected as the master;
else:
it doesn't matter,
but you'd better set a new slave quicky,
in case the reading won't be block;

2、redis的master节点下线了，怎么重新选取主节点？
可以让 System Manager selects one of the slave
Or you can set a sentinel

Redis Sentinel is a 分布式（不会英语） Structure, to imply the Failover;

1. Monitoring
2. Automatic Failover
3. select the new Master
4. Notification

When the master is unable to use, the Sentinel will begin the process of vote;
If more than half of the sentinels consider the master quorum,
then a slave will be selected as the new master
and other slaves will copy from it
then the sentinel will notify the clients to connect the new master

3、领导哨兵节点怎么从从节点中选择出主节点
随机吧，这个还真的不知道。
4、bloom过滤器的优缺点？
优点：效率很高，内存占用也不大，
缺点：
可能误判，
但是，
可能误判这一点其实也不太影响，
有一些地方不在乎，就比如说我们的数据库的缓存击穿的时候，不在乎一两个漏网之鱼
有一些地方，再格外加一层校验就可以了。

5、他的误判是假阳还是假阴？
捋一下，假阴
简单地说，
就是根据几种哈希算法，
如果你存在，对应的位 | 1，
反过来说，判断你存在，那么几种哈希算法，你的位置都应该是1，
只要不是，你必然不在，
但是即使都是，你也可以不在。

6、缓存雪崩怎么解决

1. 大量数据一块过期，
2. 解决的话，首先就需要分开设计过期时间，
3. 可以弄一点随机性
4. 然后，一般只要不是集中过期，就没有什么问题
5. 还有问题的话，
6. 我记得一个有趣的bug，
7. 一个服务器上线海外，一直出现故障
8. 原因是，这个服务器有一段时间需要备份，性能就会下降
9. 之前都是弄在晚上，
10. 然后就到 海外了。

7、redis为什么要设计成单线程

1.  性能高，就没有切换的负担了，
2.  基于内存操作，效率也很快
3.  而且，感觉就Redis的使用场景，多线程完全没有必要
4.  多进程倒是有一点点必要

8、分布式锁怎么延长过期时间？

1. 当然是选择成熟的中间件
2. 让他自己续期
   9、缓存和数据库等数据一致性，集群模式下缓存无法成功删除，缓存未成功删除时
   有哪些策略
   不知道。

11、热key问题怎么解决

1. 先识别，
2. 能够让Redis也宕机的热key实在是太恐怖了！
3. 可以让Redis分片，
4. 可以分布到不同的服务器
5. 可以使用二级缓存
   诶，问题是，同一个key怎么分散到不同的服务器上面呢？

Redis是怎么解决过期数据的？
使用了惰性过期和定时过期两种策略。
实际上，你使用定时过期就必然包括惰性过期……
太有趣的做法了。
它还有好多种内存淘汰策略，

12、分布式系统下，你觉得互斥锁有什么优缺点
优点`٩(◕‿◕)۶`

1. 安全
   缺点`(T_T)`
2. 成本
3. 性能
4. 而且，还是那一点，它无法从根本上解决分布式系统存在的问题

13、mysql一张表最多的存储数据数
不知道，

14、mysql索引B+树的常用层数是？
也不知道，我估计两层就差不多够了吧，B+树不是主打一个低层，减少I/O吗？

15、B树和B+树的区别
这个知道，
B+数所有数据都存在叶子结点上面，而且有指向下一个叶子结点的指针，
总之就非常适合数据库的索引，
16、threadlocal的底层实现
就是一个大Map，整个JVM拥有一个大Map，key是每一个线程自己，值是一个小Map，小Map的key是你创建出来的这个ThreadLocal对象本身。

17、线程池的底层实现
不知道，不就是一个被统一管理起来的很多线程组吗？
然后统一接受任务，统一处理，按照不同的策略。
18、jvm的垃圾回收机制了解吗
这个了解，方式还挺多的，
不太记得了。
19、具体讲一下G1
不记得了。
20、Ai coding和ai带给你学习上的改变
21、设计一个抖音短视频点赞系统，支持百万级并发点赞，要保证实时性和一致性，你能讲一下你的设计思路吗
肯定要使用分布式啊，
然后基于我们的CAP理论，
所以，这里的一致性就要放弃一下，而且，你说点赞吧，都几百万并发点赞了，我感觉，差一两个其实也没有影响，当然，为了严谨性，我们还是不要这么搞
「虽然刷好评这种行为让点赞的数据本来就不准确」
所以，我们完全可以采取最终一致性的做法，优先保证可用性。
点赞数据肯定要临时从Redis当中获取，
分布式的Redis，定期去同步就可以了，实时性，其实只要满足，单个用户点赞的结果自己立刻可见就行了。

麻烦你点评的时候，再附带一些补充问题，针对我只是的薄弱点。
