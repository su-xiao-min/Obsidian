Redis' three persistence ways

## RDB

The RDB persistence is to create a snapshot of the copy of a time,
After 快照创建，
就可以快乐的复制重建了，

RDB是怎么生成的
是我们fork一个子进程，
子进程执行，
不会阻塞主线程。
为什么选择子进程？
我看过这个问题，
主要是，
因为子线程炸了，
那么主线程跟着炸，
但是进程就相对隔离一些。

至于说内存问题，
这个问题不大，
我们可以开心快乐的互相映射，
实际地址和虚拟地址，
这就是操作系统的作用。

其实还有一点，
就是你既然写快照，
那么那边还在写应该怎么办，
当然是，
copyonwrite，
这样就不会影响我们的主线程。

## AOF

而且写也是分离的，
先写到AOF缓冲区，
再写到AOF文件，
再根据持久化方式fsync策略<
再写到文件

保存的位置可以自定义。

命令追加，

1. append
2. write
3. fsync
4. rewrite
5. load

也就是上面五步

我们的AOF的重写比较简单，
因为你毕竟不需要创建快照，
你是一种增量的视线，
我感觉，
也就是先弄一个缓冲区，
等你完成创建新的AOF之后，
我们再追加。
AOF的重写是直接读取数据库的键值对来实现的，
那么，
好吧，。
也需要解决一样的问题。

背八股文也解决不了问题
因为，
八股文当中根本就没有讲这些内容。

然后，

## 混合模式

也就是混合RDB & AOF
为什么这样做？
结合二者的优点。

算了，
问一下AI吧。

我的问题：

RDB 和 AOF 都是一种写的操作，
需要对于当前的状态进行一种持久化。

RDB采用一种高效的二进制进行压缩当前的数据，
问题是：
怎么实现的？
是fork 一个子进程吗？
为什么不选择线程？
RDB的时候，如果有新的写入命令，
应该怎么解决？

AOF 也是也选择fork一个子进程吗？
它和RDB有什么区别？
AOF 重写到底是怎样实现的？
如果重写的时候，还有新的写入命令，
怎么解决？
RDB & AOF 混合模式解决的问题究竟是什么？

我正在准备字节跳动的面试，
我现在对于数据库 Redis方面存在很多问题，
请你回答我的问题，
顺便，
再出一些相关的面试题。
