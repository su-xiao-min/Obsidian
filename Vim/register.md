## 前言

一些很有用的只读寄存器，
register.md
就比如说，
% 存储了当前的文件名，
`#` 存储了之前的文件名，
Ctrl + R 允许我们在INSERT MODE下使用寄存器
限定涂鸦
好强大啊。
再也不需要回到NORMAL MODE了。

使用大写字母可以在寄存器里面追加东西，
还是很有用的。
就比如说，
你的复制粘贴，
就可以一直追加。

Vim 的“剪切板”机制其实是由 **寄存器（Registers）** 实现的。理解 Vim 的寄存器系统，能让你更高效地进行复制、剪切和粘贴操作。下面我会详细讲解你关心的问题：**如何快速删除一段文本，并用当前剪切内容替换它**。

另外，还可以有一些外部的文本。

就比如说我们的
`*`：系统剪切板
`+`：组合键剪切板

下面就是一部分我复制粘贴的长文本。

使用大写字母可以在寄存器里面追加东西，
限定涂鸦
一些很有用的只读寄存器，
register.md
就比如说，
% 存储了当前的文件名，
`#` 存储了之前的文件名，
Ctrl + R 允许我们在INSERT MODE下使用寄存器

---

## 一、Vim 中的寄存器（Registers）

Vim 不像普通编辑器那样只有一个“剪切板”，而是有多个**寄存器**，每个寄存器可以存储一段文本。常用寄存器包括：

| 寄存器            | 名称           | 说明                                                                                                                   |
| ----------------- | -------------- | ---------------------------------------------------------------------------------------------------------------------- |
| `"`（无名寄存器） | `"`            | 默认寄存器。每次删除（`d`）、剪切（`x`）、复制（`y`）都会存入这里（除非指定其他寄存器）。粘贴（`p`/`P`）默认从此读取。 |
| `0`               | 复制专用寄存器 | **只有**使用 `y`（复制）时，内容会同时存入 `"0`。删除操作不会影响它。                                                  |
| `1`–`9`           | 删除历史寄存器 | 最近 9 次**删除或剪切**的内容依次存入 `1` 到 `9`。每次新删除，旧内容向后推（`1→2→3...`）。                             |
| `a`–`z`           | 命名寄存器     | 用户自定义寄存器，可显式指定（如 `"ayy` 把当前行复制到寄存器 `a`）。                                                   |
| `+` 和 `*`        | 系统剪切板     | 在支持剪贴板的 Vim（如 `vim-gtk`、`neovim`）中，`"+p` 可粘贴系统剪切板内容。                                           |

> ✅ **关键点**：当你执行 `dd` 或 `d{motion}` 删除一段文本时：
>
> - 被删内容进入 **无名寄存器 `"`**
> - 同时也进入 **删除历史寄存器 `1`**，并把之前的 `1~8` 推到 `2~9`

---

## 二、你的需求：**删除某段文本，并替换成“当前剪切板内容”**

假设你已经复制（或剪切）了一段文本（比如用 `yy` 或 `dd`），现在想：

1. **选中另一段文本**
2. **删除它**
3. **立即用之前复制的内容替换**

### ✅ 正确做法（推荐）：

```vim
" 先确保你要插入的内容在寄存器里（比如用 yy 复制了一行）
yy

" 然后移动到目标位置，进入可视模式选择要替换的文本
v      " 字符选择
V      " 行选择
Ctrl-v " 块选择

" 选好后，直接按 p（小写）
p
```

> 💡 **神奇之处**：在可视模式下按 `p`，Vim 会**自动删除选中的内容，并粘贴寄存器中的文本**！这正是你想要的“替换”效果。

### 示例流程：

1. 光标在第 5 行，按 `yy` → 复制第 5 行到 `"0` 和 `"`。
2. 移动到第 10 行，按 `V`（进入行选择模式），再按 `j` 选中第 10-12 行。
3. 按 `p` → 第 10-12 行被删除，替换成第 5 行的内容。

> ⚠️ 注意：此时被替换掉的原文本会进入寄存器 `1`，而你粘贴的内容仍保留在 `"0`（因为是用 `yy` 复制的）。

---

## 三、如果你已经“剪切”了内容（比如用了 `dd`）

问题来了：如果你用 `dd` 剪切了一行，然后又用 `dd` 删除了另一行，那么**第一次剪切的内容就被覆盖了**（因为 `dd` 写入无名寄存器 `"`）。

### 解决方案：

#### 方法 1：使用 `"0` 寄存器（最推荐！）

- 因为 `y`（复制）操作会把内容存入 `"0`，且**不会被删除操作覆盖**。
- 所以，**尽量用 `y` 而不是 `d` 来“准备要粘贴的内容”**。

操作：

```vim
yy          " 复制一行（存入 "0 和 "）
...
Vjj         " 选中三行
"0p         " 用 "0 寄存器内容替换（即使中间做过删除也不怕）
```

> 即使你中间不小心按了 `dd`，`"0` 里的内容依然安全！

#### 方法 2：使用命名寄存器（适合复杂场景）

```vim
"ayy        " 把当前行复制到寄存器 a
...
Vjj
"ap         " 用寄存器 a 的内容替换
```

---

## 四、查看寄存器内容

随时可以用以下命令查看当前寄存器内容：

```vim
:registers
```

或简写：

```vim
:reg
```

你会看到类似：

```
"0   这是我复制的内容
"1   上次删除的内容
"a   我存的备份
...
```

---

## 五、总结：最佳实践

| 场景                     | 操作                                                |
| ------------------------ | --------------------------------------------------- |
| 想“复制”一段用于后续替换 | 用 `yy` 或 `y{motion}`（这样内容会进 `"0`，安全！） |
| 想替换一段文本           | 进入可视模式（`v`/`V`/`Ctrl-v`）选中 → 按 `p`       |
| 怕内容被覆盖             | 用 `"0p` 明确粘贴最近复制的内容                     |
| 需要多次复用             | 用命名寄存器，如 `"ayy` + `"ap`                     |

---

✅ **一句话回答你的问题**：

> 进入可视模式选中文本，然后直接按 `p`，就能删除选中内容并替换成你之前复制/剪切的文本。但为了防止内容丢失，建议先用 `yy` 复制（而不是 `dd` 剪切），这样可以用 `"0p` 安全粘贴。

希望这能帮你彻底掌握 Vim 的“剪切板”逻辑！如果还有不清楚的地方，欢迎继续问 😊
